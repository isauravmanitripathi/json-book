# Generate content for the book

So this is the directory which we will use to generate the content for my book. We will use gemini and it's deep research feature to do so.

Before 


# Step: 1 
### Run the write-outline-gemini.py 

- This is the command which is used to run the file: python write-outline-gemini.py --input_file path/to/your/input.json --output_dir results/Outlines


Generate a json file with proper structure which we will feed to our system to generate content for us.

So it accepts this json file with this structure:

```json
{
  "bookTitle": "Optional: The Title of the Book", // Optional, used for logging/display
  "parts": [ // REQUIRED: A list of book parts
    {
      "name": "Optional: Name of Part 1", // Optional, used in prompt context
      "chapters": [ // REQUIRED: A list of chapters within this part
        {
          "title": "REQUIRED: Title of Chapter 1.1", // REQUIRED: Used in the prompt
          "description": "REQUIRED: A detailed description or goal for Chapter 1.1. This is the core input for the outline generation." // REQUIRED: Used in the prompt
          // Other keys might exist here, but the script only uses 'title' and 'description'
        },
        {
          "title": "REQUIRED: Title of Chapter 1.2",
          "description": "REQUIRED: Description for Chapter 1.2."
        }
        // ... more chapters in Part 1
      ]
    },
    {
      "name": "Optional: Name of Part 2",
      "chapters": [
        {
          "title": "REQUIRED: Title of Chapter 2.1",
          "description": "REQUIRED: Description for Chapter 2.1."
        }
        // ... more chapters in Part 2
      ]
    }
    // ... more parts in the book
  ]
}

```

Now moving on to the next part we are going to parse the json file, break it down send it to the api and generate outline for it.

This is the json it creates in response:

```json 
{
  "bookTitle": "Optional: The Title of the Book", // Same as input
  "parts": [ // Same structure as input
    {
      "name": "Optional: Name of Part 1", // Same as input
      "chapters": [ // Same structure as input
        {
          "title": "REQUIRED: Title of Chapter 1.1", // Same as input
          "description": "REQUIRED: Description for Chapter 1.1.", // Same as input
          // Other original keys (if any) are preserved
          "generated_outline": { // <<< THIS IS THE ADDED PART >>>
            "chapter_title_suggestion": "A concise, potentially refined title based on the input.",
            "writing_sections": [
              {
                "section_title": "Proposed Title for Section 1 (Descriptive)",
                "content_points_to_cover": [
                  "Detailed point 1: Specific concept/topic/event to cover.",
                  "Detailed point 2: Elaboration on another key aspect.",
                  "Detailed point 3: Suggested connections or comparisons."
                  // ... more points as generated by the API
                ],
                "Google Search_terms": [ // Corrected key name from potential typo in prompt template (was Search_terms)
                  "Specific search query for point 1 research",
                  "Broader search term for Section 1 topic",
                  "Keyword phrase for examples/case studies"
                   // ... more search terms as generated by the API
                ]
              },
              {
                "section_title": "Proposed Title for Section 2",
                "content_points_to_cover": [
                  "Detailed point 2.1: Breakdown of the next logical part.",
                  "Detailed point 2.2: Specific arguments or evidence suggested.",
                  // ...
                ],
                "Google Search_terms": [
                  "Search query for Section 2 content",
                  "Alternative phrasing for research",
                  // ...
                ]
              }
              // ... more sections generated by the API based on the description
            ]
          } // <<< END OF ADDED PART >>>
        },
        {
          "title": "REQUIRED: Title of Chapter 1.2",
          "description": "REQUIRED: Description for Chapter 1.2.",
          "generated_outline": {
            // ... structure as above, generated for Chapter 1.2 ...
            // OR, if API failed for this chapter:
            // "error": "Failed to generate outline after N attempts.",
            // "chapter_title_suggestion": "Error: Outline Generation Failed",
            // "writing_sections": [
            //   {
            //     "section_title": "Error",
            //     "content_points_to_cover": ["API call failed to produce outline content."],
            //     "Google Search_terms": ["error retrieving data"]
            //   }
            // ]
          }
        }
        // ... more chapters in Part 1, each with a 'generated_outline'
      ]
    },
    // ... more parts, each with chapters containing 'generated_outline'
  ]
}
```

# Step 2:

This is a Python script that uses Google's Gemini AI to convert a structured outline of UPSC study material into fully written content. It takes a JSON outline with parts, chapters, and bullet points, then elaborates each point into detailed paragraphs while maintaining context between sections.

## How to Run

```bash
# Install dependencies
pip install google-generativeai python-dotenv rich

# Create .env file with API key
echo "GOOGLE_API_KEY=your_api_key_here" > .env

# Run the script
python content_generator.py --input_file=your_outline.json --output_dir=results/Content
```

## Input JSON Structure

```json
{
  "bookTitle": "India's International Relations for UPSC",
  "parts": [
    {
      "name": "Bilateral Relations",
      "chapters": [
        {
          "title": "Chapter Title",
          "generated_outline": {
            "writing_sections": [
              {
                "section_title": "India-US Relations",
                "content_points_to_cover": [
                  "Historical background of India-US relations",
                  "Strategic partnership in the 21st century",
                  "Areas of cooperation and conflict"
                ]
              }
            ]
          }
        }
      ]
    }
  ]
}
```

## Output JSON Structure

```json
{
  "bookTitle": "India's International Relations for UPSC",
  "generation_model": "gemini-1.5-flash-8b",
  "generation_timestamp": "2025-04-12T10:30:00.000Z",
  "parts": [
    {
      "part_number": "A1",
      "name": "Bilateral Relations",
      "chapters": [
        {
          "chapter_number": 1,
          "title": "India-US Relations",
          "content": [
            {
              "item_number": "1.1",
              "type": "introduction",
              "text": "This chapter explores the complex relationship between India and the United States..."
            },
            {
              "item_number": "1.2",
              "type": "point",
              "original_point": "Historical background of India-US relations",
              "text": "The India-US relationship has evolved significantly since India's independence in 1947..."
            },
            // Additional elaborated points follow
          ]
        }
      ]
    }
  ]
}
```

The program automatically tracks progress in a log file, allowing you to resume interrupted processing, and includes features like rate limiting, error recovery, and incremental saves to prevent data loss.